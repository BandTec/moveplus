<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard MovePlus</title>
    <link rel="sortcut icon" href="../Login/img/favicon.png" type="image/x-icon" />
    <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="./css/tablet.css">
    <link rel="stylesheet" href="./css/desktop.css">
</head>

<body style="background-color: #FCFDFF;">
    <header>
        <nav>
            <div class="esconder">
                <div class="icon-menuHamburguer">
                    <img src="./img/icon-menu-hamburgue.png" alt="">
                </div>
                <div class="profile-notification">
                    <div class="popup" onclick="myFunction()">
                        <span class="popuptext" id="myPopup">
                            <h3>
                                Notificações
                            </h3>
                            <p>
                                Sem novas Notificações
                            </p>
                        </span>
                        <img src="./img/icon-notification2.png" alt="" style="margin: 5px 10px 0 0; width: 37px;">
                    </div>

                    <div class="profile-menu" id="btnMobileProf">
                        <img src="./img/perfil (2).png" alt="" class="img-profile">
                        <i class="fas fa-angle-down"></i>
                        <div class="menu-profile">
                            <ul>
                                <li>
                                    <a href="./perfil.html">
                                        <i class="material-icons">person</i>
                                        Perfil
                                    </a>
                                </li>

                                <li>
                                    <a href="#">
                                        <i class="material-icons">help_outline</i>
                                        Ajuda
                                    </a>
                                </li>

                                <li class="btn-logout" onclick="logout()" style="position: relative;">
                                    <a style="cursor: pointer;">
                                        <i class="material-icons">power_settings_new</i>
                                        Sair da conta
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <ul class="menu-hidden" id="menuHidden">
                <div class="logo">
                    <img src="./img/logomove-removebg-preview.png" alt="">
                </div>

                <div class="logo img-menu-profile">
                    <div class="img-menu">
                        <img src="./img/perfil (2).png" alt="" style=" width: 100%;">
                    </div>
                    <h3 style="color: white; margin: 5px 0; text-transform: uppercase; font-size: 14px;" id="nomeMenu"></h3>
                    <p style="color: white; font-size: 14px; font-weight: 300;" id="credMenu"></p>
                </div>

                <li class="item-active">
                    <a href="./dash.html">
                        <i class="material-icons icon-active">dashboard</i>
                        Dashboard
                    </a>
                </li>

                <li>
                    <a href="./cadTerminais.html">
                        <i class="material-icons">add_to_queue</i>
                        Nova Maquina
                    </a>
                </li>

                <li>
                    <a href="./perfil.html">
                        <i class="material-icons">person</i>
                        Perfil
                    </a>
                </li>

                <li>
                    <a href="#">
                        <i class="material-icons">help_outline</i>
                        Ajuda
                    </a>
                </li>


                <li class="btn-logout" onclick="logout()" style="cursor: pointer;">
                    <a style="cursor: pointer;">
                        <i class="material-icons">power_settings_new</i>
                        Sair da conta
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="container-flex">
            <div class="flex-station">
                <div class="viewStation">
                    <div class="station">
                        <p id="nomeEstacao"></p>
                    </div>
                    <div class="profile-notification perfil-desk">
                        <div class="popover">
                            <img src="./img/icon-notification2.png" alt="" class="active-pop">
                            <div class="pop">
                                <div class="popuptext">
                                    <div style="padding: 20px 30px; box-sizing: border-box;">
                                        <h3>
                                            Notificações
                                        </h3>
                                        <p>
                                            Sem novas Notificações
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="profile">
                            <img src="./img/perfil (2).png" alt="" class="img-profile">

                            <h3 class="muda" id="user" style="color: #222222;"></h3>

                            <i class="fas fa-angle-down" id="info-profile" style="color: #3d3d3d;"></i>

                            <i class="fas fa-angle-up" id="up-profile" style="color: white !important; display:none;"></i>
                            <div class="profile-active">

                                <ul>
                                    <li>
                                        <a href="./perfil.html">
                                            <i class="material-icons">person</i>
                                            Perfil
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <i class="material-icons">help_outline</i>
                                            Ajuda
                                        </a>
                                    </li>

                                    <li class="btn-logout" onclick="logout()" style="position: relative;">
                                        <a>
                                            <i class="material-icons">power_settings_new</i>
                                            Sair da conta
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex-station">
                <div class="viewMachines">
                    <h3>Dashboard</h3>
                    <p>Olá, bem vindo de volta !</p>
                </div>

                <div class="cards-dash">
                    <div class="card">
                        <div>
                            <div class="icon-card">
                                <img src="./img/icon-maquina-cartao.png" alt="">
                            </div>
                            <div class="text-card">
                                <h3>Total de maquinas</h3>
                                <p>10</p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div>
                            <div class="icon-card">
                                <img src="./img/icon-maquina-cartao.png" alt="">
                            </div>
                            <div class="text-card">
                                <h3>Maquinas Ativas</h3>
                                <p>9</p>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div>
                            <div class="icon-card">
                                <img src="./img/icon-maquina-cartao.png" alt="">
                            </div>
                            <div class="text-card">
                                <h3>Maquinas inativas</h3>
                                <p>1</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="viewMachines graph">
                    <p class="darkP">Selecione abaixo a <span>maquina</span> que voce deseja visualizar !</p>

                    <select name="estações" id="estacao" onchange="switchValues()">
                    </select>

                    <p class="darkP">Terminal Funcionando.</p>

                    <div>
                        <div>
                            <p class="info-machine"><span>CPU</span></p>
                            <div>
                                <canvas id="graphCpu" class="line-chart-cpu" style="height: 100%; width: 100%;">

                                </canvas>
                            </div>
                        </div>

                        <div>
                            <p class="info-machine"><span>Memória RAM</span></p>
                            <div>
                                <canvas id="graphRam" class="line-chart-ram" style="height: 100%; width: 100%;">

                                </canvas>
                            </div>
                        </div>

                        <div>
                            <p class="info-machine"><span>Disco 0 (c:)</span></p>
                            <div>
                                <canvas class="line-chart-disco" id="graphDisco" style="height: 100%; width: 100%; margin: 0; padding: 0;">

                                </canvas>
                            </div>
                        </div>

                    </div>

                </div>
                <footer>
                    <div class="copy">
                        <h3>© MovePlus 2020</h3>
                        <p>Todos os direitos reservados.</p>
                    </div>
                </footer>
            </div>
            </div>
        </section>
    </main>
</body>

</html>
<script src="../Login/script.js"></script>
<script src="./js/auth.js"></script>
<script src="./js/helpdesk.js"></script>
<script src="./js/menuMobile.js"></script>
<script src="./js/popUp.js"></script>
<script src="./js/graph.js"></script>
<script src="./js/graphDisco.js"></script>
<script src="./js/graphRam.js"></script>
<script src="./js/exibir.js"></script>
<script src="./js/metrica.js"></script>
<script>

    const user = JSON.parse(sessionStorage.user);
    const identityUser = document.querySelector("#user");
    const identityUserMenu = document.getElementById("nomeMenu");
    const credencialUserMenu = document.getElementById("credMenu");

    identityUser.innerHTML = user.email;
    identityUserMenu.innerHTML = user.email;
    credencialUserMenu.innerHTML = user.credencial;

    const btnProfMenu = document.querySelector("#btnMobileProf");
    const activeProfMenu = document.querySelector(".menu-profile");

    function activeProf() {
        activeProfMenu.classList.toggle("popBlock");
    }

    btnProfMenu.addEventListener("click", activeProf);

    function getTerminais() {
        const user = JSON.parse(sessionStorage.user);
        console.log(user);

        fetch(`http://localhost:3333/terminais/${user.estacao}`, { cache: 'no-store' })
            .then(response => {
                if (response.ok) {
                    response.json().then(res => {
                        console.log(res);
                        res.map(term => {
                            estacao.innerHTML += `<option value="${term.idTerminal}">${term.nomeTerminal}</option>`;
                        })
                        obterDados();
                        obterDados1();
                        obterDados2();
                    })
                }
            })
    }

    function switchValues() {
        obterDados();
        obterDados1();
        obterDados2();
    }

    window.onload = function () {
        getTerminais();
    };
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>