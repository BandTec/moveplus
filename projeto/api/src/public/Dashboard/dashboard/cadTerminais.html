<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de terminais MovePlus</title>
    <link rel="sortcut icon" href="../Login/img/favicon.png" type="image/x-icon" />
    <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="./css/tablet.css">
    <link rel="stylesheet" href="./css/desktop.css">
    <link rel="stylesheet" href="./css/profile.css">
    <link rel="stylesheet" href="./css/cadastro.css">
</head>

<body>
    <header>
        <nav>
            <div class="esconder">
                <div class="icon-menuHamburguer">
                    <img src="./img/icon-menu-hamburgue.png" alt="">
                </div>
                <div class="profile-notification">
                    <div class="popup" onclick="myFunction()">
                        <span class="popuptext" id="myPopup">
                            <h3>
                                Notificações
                            </h3>
                            <p>
                                Sem novas Notificações
                            </p>
                        </span>
                        <img src="./img/icon-notification2.png" alt="" style="margin: 5px 10px 0 0; width: 37px;">
                    </div>

                    <div class="profile-menu" id="btnMobileProf">
                        <img src="./img/perfil (2).png" alt="" class="img-profile">
                        <i class="fas fa-angle-down"></i>
                        <div class="menu-profile">
                            <ul>
                                <li>
                                    <a href="./perfil.html">
                                        <i class="material-icons">person</i>
                                        Perfil
                                    </a>
                                </li>

                                <li>
                                    <a href="#">
                                        <i class="material-icons">help_outline</i>
                                        Ajuda
                                    </a>
                                </li>

                                <li class="btn-logout" onclick="logout()" style="position: relative;">
                                    <a>
                                        <i class="material-icons">power_settings_new</i>
                                        Sair da conta
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <ul class="menu-hidden" id="menuHidden">
                <div class="logo">
                    <img src="./img/logomove-removebg-preview.png" alt="">
                </div>

                <div class="logo img-menu-profile">
                    <div class="img-menu">
                        <img src="./img/perfil (2).png" alt="" style=" width: 100%;">
                    </div>
                    <h3 style="color: white; margin: 5px 0; text-transform: uppercase; font-size: 14px;" id="nomeMenu"></h3>
                    <p style="color: white; font-size: 14px; font-weight: 300;" id="credMenu"></p>
                </div>

                <li>
                    <a href="./dash.html">
                        <i class="material-icons icon-active">dashboard</i>
                        Dashboard
                    </a>
                </li>

                <li class="item-active">
                    <a href="./cadTerminais.html">
                        <i class="material-icons">add_to_queue</i>
                        Nova Maquina
                    </a>
                </li>

                <li>
                    <a href="./perfil.html">
                        <i class="material-icons">person</i>
                        Perfil
                    </a>
                </li>

                <li>
                    <a href="#">
                        <i class="material-icons">help_outline</i>
                        Ajuda
                    </a>
                </li>

                <li class="btn-logout" onclick="logout()">
                    <a>
                        <i class="material-icons">power_settings_new</i>
                        Sair da conta
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="container-flex">
            <div class="flex-station">
                <div class="viewStation">
                    <div class="station">
                        <p id="nomeEstacao"></p>
                    </div>
                    <div class="profile-notification perfil-desk">
                        <div class="popover">
                            <img src="./img/icon-notification2.png" alt="" class="active-pop">
                            <div class="pop">
                                <div class="popuptext">
                                    <div style="padding: 20px 30px; box-sizing: border-box;">
                                        <h3>
                                            Notificações
                                        </h3>
                                        <p>
                                            Sem novas Notificações
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="profile">
                            <img src="./img/perfil (2).png" alt="" class="img-profile">

                            <h3 class="muda" id="user" style="color: #222222;"></h3>

                            <i class="fas fa-angle-down" id="info-profile" style="color: #3d3d3d;"></i>

                            <i class="fas fa-angle-up" id="up-profile" style="color: white !important; display:none;"></i>
                            <div class="profile-active">

                                <ul>
                                    <li>
                                        <a href="./perfil.html">
                                            <i class="material-icons">person</i>
                                            Perfil
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <i class="material-icons">help_outline</i>
                                            Ajuda
                                        </a>
                                    </li>

                                    <li class="btn-logout" onclick="logout()" style="position: relative;">
                                        <a>
                                            <i class="material-icons">power_settings_new</i>
                                            Sair da conta
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ------------------------- -->

            <div class="flex-profile">
                <div class="flex">
                    <div class="viewProfile">
                        <h3>Cadastrar terminal</h3>
                        <p>Aqui será possível o cadastro de novas maquinas!</p>
                    </div>
                    <div class="cards-profile">
                        <div class="cadMachine">
                            <button data-modal="abrir">
                                Novo Terminal
                            </button>
                            <input type="text" placeholder="Pesquisar terminal">
                        </div>
                        <div class="cards" id="listTerminais">

                        </div>
                    </div>
                </div>
                <footer>
                    <div class="copy">
                        <h3>© MovePlus 2020</h3>
                        <p>Todos os direitos reservados.</p>
                    </div>
                </footer>
            </div>
            </div>
        </section>
    </main>
    <section class="modal-container" data-modal="container">
        <div class="modal">
            <button data-modal="fechar" class="fechar">X</button>
            <form action="">

                <div class="form-group">
                    <label for="">Nome do Terminal</label>
                    <input type="text" placeholder="TERM-NORTE-01" id="nomeTerm" class="form-control" />

                </div>

                <div class="form-group">
                    <label for="">Numero de série</label>
                    <input type="text" placeholder="ZXCVB98765" id="numSerie" class="form-control" />

                </div>

                <button id="cadMachine">Cadastrar</button>
            </form>
        </div>
    </section>
</body>

</html>
<script src="../Login/script.js"></script>
<script src="./js/auth.js"></script>
<script src="./js/helpdesk.js"></script>
<script src="./js/menuMobile.js"></script>
<script src="./js/popUp.js"></script>
<script src="./js/exibir.js"></script>
<script src="./js/modal.js"></script>
<script>

    const user = JSON.parse(sessionStorage.user);
    const identityUser = document.querySelector("#user");
    const identityUserMenu = document.getElementById("nomeMenu");
    const credencialUserMenu = document.getElementById("credMenu");

    identityUserMenu.innerHTML = user.email;
    credencialUserMenu.innerHTML = user.credencial;
    identityUser.innerHTML = user.email;


    localStorage.setItem("email", user.email);

    const btnProfMenu = document.querySelector("#btnMobileProf");
    const activeProfMenu = document.querySelector(".menu-profile");

    function activeProf() {
        activeProfMenu.classList.toggle("popBlock");
    }

    btnProfMenu.addEventListener("click", activeProf);

    const us = JSON.parse(sessionStorage.getItem('user'));
    fetch(`http://localhost:3333/terminais/${us.estacao}`).then(response => {
        if (response.ok) {
            console.log(response);
            response.json().then(res => {
                console.log(res);
                const terminais = document.getElementById('listTerminais');
                res.map((term) => {
                    terminais.innerHTML += `<div>${term.nomeTerminal}${term.statusTerminal}</div>`;
                })
            })
        }
    })

    const cad = document.querySelector("#cadMachine");
    function cadastrar(event) {
        event.preventDefault();
        const nome = document.querySelector("#nomeTerm");
        const numero = document.querySelector("#numSerie");

        cadMaquina(
            nome.value,
            numero.value
        );
    }
    cad.addEventListener("click", cadastrar);



</script>